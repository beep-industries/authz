# Default values for authz-listeners

replicaCount: 1

image:
  repository: ghcr.io/beep-industries/authz
  tag: "0.0.1"
  pullPolicy: IfNotPresent

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# Application configuration
config:
  authzed:
    # SpiceDB/AuthZed gRPC endpoint
    endpoint: "spicedb:50051"
    # Use insecure connection (no TLS)
    insecure: "true"
  rabbitmq:
    # Suffix appended to consumer tags for identification
    consumerTagSuffix: "default"
  # Rust log level (trace, debug, info, warn, error)
  logLevel: "info"

# Secrets configuration
secrets:
  # SpiceDB pre-shared key for authentication
  authzedToken: ""
  # RabbitMQ connection URI (amqp://user:pass@host:port)
  rabbitUri: ""
  # Use existing secret instead of creating one
  # If set, secrets.authzedToken and secrets.rabbitUri are ignored
  existingSecret: ""

# Queue configuration (maps to queues.json)
queues:
  server:
    create_server: "create.server.queue"
    delete_server: "delete.server.queue"
  channel:
    create_channel: "create.channel.queue"
    delete_channel: "delete.channel.queue"
  role:
    upsert_role: "role.upsert.queue"
    delete_role: "role.delete.queue"
    member_assigned_to_role: "member.assign.role.queue"
    member_removed_from_role: "member.unassign.role.queue"
  permission_override:
    upsert_permission_override: "permission_override.upsert_permission_override.queue"
    delete_permission_override: "permission_override.delete_permission_override.queue"

# Resource limits and requests
resources:
  limits:
    cpu: 500m
    memory: 256Mi
  requests:
    cpu: 100m
    memory: 128Mi

# Pod scheduling constraints
nodeSelector: {}
tolerations: []
affinity: {}

# Pod annotations
podAnnotations: {}

# Pod security context
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1001
  runAsGroup: 1001
  fsGroup: 1001

# Container security context
securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL
